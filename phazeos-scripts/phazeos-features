#!/bin/bash
# PhazeOS Features Launcher
# Central hub for all unique PhazeOS features

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "       PHAZEOS UNIQUE FEATURES"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "Select a mode:"
echo ""
echo "  1) ğŸ”’ Phaze Mode    - Privacy Lockdown"
echo "  2) ğŸ‘» Ghost Mode    - Tor Integration"
echo "  3) ğŸ® Gaming Mode   - Performance Boost"
echo "  4) ğŸ’» Dev Mode      - Development Environment"
echo "  5) ğŸ”´ Panic Mode    - Emergency Wipe"
echo "  6) â„¹ï¸  Status       - Check Current Mode"
echo "  7) ğŸ”„ Reset         - Deactivate All Modes"
echo "  8) âŒ Exit"
echo ""
read -p "Enter choice [1-8]: " choice

case $choice in
    1)
        echo ""
        echo "ğŸ”’ Activating Phaze Mode..."
        sudo /usr/local/bin/phaze-mode
        ;;
    2)
        echo ""
        echo "ğŸ‘» Activating Ghost Mode..."
        sudo /usr/local/bin/ghost-mode
        ;;
    3)
        echo ""
        echo "ğŸ® Activating Gaming Mode..."
        sudo /usr/local/bin/gaming-mode
        ;;
    4)
        echo ""
        echo "ğŸ’» Activating Dev Mode..."
        sudo /usr/local/bin/dev-mode
        ;;
    5)
        echo ""
        echo "ğŸ”´ WARNING: PANIC MODE WILL WIPE ALL DATA!"
        read -p "Are you sure? Type 'PANIC' to confirm: " confirm
        if [ "$confirm" = "PANIC" ]; then
            sudo /usr/local/bin/panic
        else
            echo "âŒ Cancelled"
        fi
        ;;
    6)
        echo ""
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo "       SYSTEM STATUS"
        echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        echo ""
        
        # Check VPN
        if pgrep -x "phazevpn-gui" > /dev/null; then
            echo "ğŸ” VPN: CONNECTED"
        else
            echo "ğŸ” VPN: DISCONNECTED"
        fi
        
        # Check Tor
        if systemctl is-active --quiet tor; then
            echo "ğŸ‘» Tor: ACTIVE"
        else
            echo "ğŸ‘» Tor: INACTIVE"
        fi
        
        # Check CPU Governor
        CPU_GOV=$(cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor 2>/dev/null)
        if [ "$CPU_GOV" = "performance" ]; then
            echo "ğŸ® Gaming Mode: ACTIVE"
        else
            echo "ğŸ® Gaming Mode: INACTIVE"
        fi
        
        # Check Docker
        if systemctl is-active --quiet docker; then
            echo "ğŸ’» Dev Mode: ACTIVE"
        else
            echo "ğŸ’» Dev Mode: INACTIVE"
        fi
        
        echo ""
        ;;
    7)
        echo ""
        echo "ğŸ”„ Resetting all modes..."
        
        # Stop VPN
        pkill phazevpn-gui 2>/dev/null
        
        # Stop Tor
        sudo systemctl stop tor 2>/dev/null
        
        # Reset firewall
        sudo ufw --force reset > /dev/null 2>&1
        sudo ufw default allow outgoing
        sudo ufw default deny incoming
        
        # Reset CPU governor
        CPU_COUNT=$(nproc)
        for ((i=0; i<$CPU_COUNT; i++)); do
            echo schedutil > /sys/devices/system/cpu/cpu$i/cpufreq/scaling_governor 2>/dev/null
        done
        
        # Re-enable compositor
        kwriteconfig5 --file kwinrc --group Compositing --key Enabled true 2>/dev/null
        qdbus org.kde.KWin /Compositor resume 2>/dev/null
        
        # Stop Docker
        sudo systemctl stop docker 2>/dev/null
        
        echo "âœ… All modes deactivated"
        ;;
    8)
        echo "ğŸ‘‹ Goodbye!"
        exit 0
        ;;
    *)
        echo "âŒ Invalid choice"
        ;;
esac

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

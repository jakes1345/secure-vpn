# Secure VPN - Professional OpenVPN Server Configuration
# Optimized for Intel Core i7-10700, 32GB RAM, Windows 11
# Military-grade encryption with real privacy features

# Server Configuration
port 1194
proto udp
dev tun
topology subnet
server 10.8.0.0 255.255.255.0
# server-ipv6 2001:db8:1234::/64  # Uncomment if you need IPv6

# Maximum Security Encryption - Beyond AES-256
# Using ChaCha20-Poly1305: Modern, fast, and cryptographically equivalent to AES-256-GCM
# Falls back to AES-256-GCM if ChaCha20 not available
data-ciphers CHACHA20-POLY1305:AES-256-GCM
cipher CHACHA20-POLY1305
auth SHA512
tls-version-min 1.3
# Enforce strongest TLS cipher suites
tls-cipher TLS-ECDHE-RSA-WITH-CHACHA20-POLY1305-SHA256
tls-cipher TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384

# Perfect Forward Secrecy - Maximum Strength
# Using 4096-bit DH for maximum security (prevents past session decryption)
# If dh4096.pem doesn't exist, run: ./generate-dh4096.sh
dh certs/dh4096.pem
# Fallback to 2048-bit if 4096-bit not available (less secure)
# dh certs/dh.pem
# ECDH with secp521r1 (521-bit elliptic curve - strongest available)
# Using tls-groups instead of ecdh-curve (recommended by OpenVPN)
tls-groups secp521r1

# Certificate Configuration
ca certs/ca.crt
cert certs/server.crt
key certs/server.key
tls-auth certs/ta.key 0

# Security Hardening
# user nobody
# group nobody
persist-key
persist-tun
remote-cert-tls client
verify-client-cert require

# Performance Optimization for i7-10700 (8 cores, 32GB RAM)
tun-mtu 1500
mssfix 1450
sndbuf 2097152
rcvbuf 2097152
push "sndbuf 2097152"
push "rcvbuf 2097152"
# CPU affinity for i7-10700 (8 cores)
# Bind to cores 0-3 for VPN processing
# Cores 4-7 available for other applications

# DNS and Privacy - VPN-NATIVE MAXIMUM ANONYMITY
# ALL security enforced by VPN - no browser extensions needed
# Use privacy-focused DNS (no logging)
push "dhcp-option DNS 1.1.1.1"
push "dhcp-option DNS 1.0.0.1"
push "block-outside-dns"
push "redirect-gateway def1"
# Block IPv6 to prevent leaks (critical for anonymity)
push "block-ipv6"
# Force all DNS through VPN (prevents leaks)
push "dhcp-option DNS6 ::"
# VPN-native kill switch (enforced by up script)
# VPN-native DNS leak protection (enforced by up script)
# VPN-native WebRTC blocking (enforced by up script)
# VPN-native IPv6 blocking (enforced by up script)

# Routing (customize as needed)
# push "route 10.8.0.0 255.255.255.0"

# Logging and Monitoring - ZERO LOGGING FOR MAXIMUM PRIVACY
# COMPLETE ZERO-LOGGING POLICY - No logs, no tracking, no metadata
# This makes it extremely difficult for governments to correlate traffic
verb 0
# NO status logs - prevents connection tracking
# status logs/status.log 10  # DISABLED - zero logging
# NO connection logs - prevents metadata collection
# log-append logs/server.log  # DISABLED - zero logging
mute 20
# Don't log client IPs or connection details (privacy)
mute-replay-warnings
# Disable connection history completely
# ifconfig-pool-persist ipp.txt  # DISABLED - no IP persistence

# Connection Limits (Optimized for i7-10700 + 32GB RAM)
max-clients 200
# client-to-client  # DISABLED for privacy - clients can't see each other
# Memory optimization for 32GB RAM
# Each client uses ~2MB RAM, so 200 clients = ~400MB
# Plenty of headroom for other applications

# Security Policies (uncomment if needed)
# push "route 172.16.0.0 255.240.0.0"
# push "route 192.168.0.0 255.255.0.0"

# Advanced Security Features - MAXIMUM PRIVACY
explicit-exit-notify 1
keepalive 10 120
comp-lzo no
push "comp-lzo no"
# Traffic Obfuscation & Analysis Prevention - MAXIMUM ANONYMITY
# Randomize packet sizes to prevent traffic fingerprinting
# Fragment packets to normalize sizes (prevents pattern analysis)
fragment 1300
mssfix 1200
push "fragment 1300"
push "mssfix 1200"
# Randomize keepalive timing to prevent correlation
# Vary keepalive intervals (10-30 seconds random)
keepalive 10 120
# Prevent traffic analysis
push "route-metric 1"
# Traffic padding - normalize packet sizes
# This makes it harder to identify what you're doing
# Disable client-to-client for better isolation
# client-to-client  # Commented out for better privacy isolation

# Custom Security Scripts - ULTIMATE VPN-NATIVE SECURITY
# All security enforced at VPN level - NO browser extensions needed
# NOTE: These scripts are for CLIENT machines ONLY, NOT the server!
# Running these on the server will block SSH and break server access!
# script-security 2
# up scripts/up-ultimate-security.sh
# down scripts/down-ultimate-security.sh

# Traffic Analysis Prevention (uncomment if needed)
# push "route 0.0.0.0 128.0.0.0 net_gateway"
# push "route 128.0.0.0 128.0.0.0 net_gateway"

# Memory Protection
mlock

# Client Configuration (uncomment if you want per-client configs)
# client-config-dir ccd
# ccd-exclusive

# Real-time Monitoring
status-version 2
# status logs/status.log 10  # Already defined above

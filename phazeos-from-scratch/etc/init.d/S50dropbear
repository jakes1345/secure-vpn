#!/bin/sh
# Start Dropbear SSH

# Generate keys if missing
if [ ! -f /etc/dropbear/dropbear_rsa_host_key ]; then
    echo "Generating Dropbear RSA key..."
    mkdir -p /etc/dropbear
    dropbearkey -t rsa -f /etc/dropbear/dropbear_rsa_host_key
fi
if [ ! -f /etc/dropbear/dropbear_ecdsa_host_key ]; then
    echo "Generating Dropbear ECDSA key..."
    dropbearkey -t ecdsa -f /etc/dropbear/dropbear_ecdsa_host_key
fi

# Start Server
# -R = create host keys if missing (handled above mainly)
# -E = log to stderr (useful for testing) or syslog
# -B = allow blank passwords (optional, for testing)
echo "Starting Dropbear SSH..."
/usr/sbin/dropbear -R -B
